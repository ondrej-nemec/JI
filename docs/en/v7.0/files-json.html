<h1>JSON</h1>

<p>
	JI Files provides two ways how to work with JSON - directly write to/read from JSON stream and automatic file read from/write to objects.
</p>

<h2>JSON stream</h2>

<p>With JSON stream you write/read JSON parts one by one. JI see JSON as objects (<code>{}</code>), lists (<code>[]</code>) and items (values). All three entities can have their name, if they are inside object. Objects and lists have start and end.</p>

<h3>OutpuJsonStream</h3>

<p>
	For creating <code>OutputJsonStream</code> you need <code>OutputProvider</code> (see below) and (optionally) <code>boolean</code> parameter <code>formated</code> (switch, if print human-readable or not. Default false). <code>OutputJsonStream</code> is closable. The <code>close</code> method close <code>OutputProvider</code>.
</p>

<strong>API</strong>
<p class="alert alert-dark code"><code>
	<span class="comment">// object start - '{' - in list or empty file</span> <br>
	stream.writeObjectStart(); <br>
	<span class="comment">// object start - '{' - in object</span> <br>
	stream.writeObjectStart(name); <br>
	<span class="comment">// object end - '}'</span> <br>
	stream.writeObjectEnd(); <br>

	<span class="comment">// list start - '[' - in list or empty file</span> <br>
	stream.writeListStart(); <br>
	<span class="comment">// list start - '[' - in object</span> <br>
	stream.writeListStart(name); <br>
	<span class="comment">// list end - ']'</span> <br>
	stream.writeListEnd(); <br>


	<span class="comment">// primitive or String value - in list</span> <br>
	stream.writeListValue(value); <br>
	<span class="comment">// primitive or String value - in object</span> <br>
	stream.writeObjectValue(name, value); <br>
</code></p>

<strong>Example: construct</strong>
<p class="alert alert-dark code"><code>
	OutputProvider provider = ...; <br>
	OutputJsonStream stream = <span class="keyword">new</span> OutputJsonStream(provider); <br>
	<span class="comment">// your code</span>
	stream.close(); <br>
</code></p>

<strong>Example: writing</strong>

<p><code>
{ <br>
<span class="tab"></span>"item1": 123,<br>
<span class="tab"></span>"item2": "value",<br>
<span class="tab"></span>"item-list": [ <br>
<span class="tab"></span><span class="tab"></span>"one", <br>
<span class="tab"></span><span class="tab"></span>2, <br>
<span class="tab"></span><span class="tab"></span>false, <br>
<span class="tab"></span><span class="tab"></span>NULL <br>
<span class="tab"></span>],<br>
<span class="tab"></span>"item-object": { <br>
<span class="tab"></span><span class="tab"></span>"subItem": "value" <br>
<span class="tab"></span>} <br>
}
</code></p>

<p class="alert alert-dark code"><code>
	stream.writeObjectStart(); <br>
	stream.writeObjectValue(<span class="text">"item1"</span>, 123); <br>
	stream.writeObjectValue(<span class="text">"item2"</span>, <span class="text">"value"</span>); <br>
	stream.writeListStart(<span class="text">"item-list"</span>); <br>
	stream.writeListValue(<span class="text">"one"</span>); <br>
	stream.writeListValue(2); <br>
	stream.writeListValue(false); <br>
	stream.writeListValue(null); <br>
	stream.writeListEnd(); <br>
	stream.writeObjectStart(<span class="text">"item-object"</span>); <br>
	stream.writeObjectItem(<span class="text">"subItem"</span>, <span class="text">"value"</span>); <br>
	stream.writeObjectEnd(); <br>
	stream.writeObjectEnd();
</code></p>

<h4>OutputProvider</h4>

<p>
	Write data. JI Files contains two implementations:

	<ul>
		<li><code>OutputStringProvider</code>: write JSON into <code>String</code>. The result is available on <code>getJson</code> method.</li>
		<li><code>OutputWriterProvider</code>: write JSON into given <code>Writer</code>. The <code>OutputWriterProvider::close()</code> close <code>Writer</code>.</li>
	</ul>
</p>

<h3>InputJsonStream</h3>

<p>
	For creating <code>InputJsonStream</code> you need <code>InputProvider</code> (see below). The stream is controlled with <code>next</code>method<code>. This method returns <code>Event</code> that provide you all required information. InputJsonStream</code> is closable. The <code>close</code> method close <code>InputProvider</code>.
</p>

<strong>Event</strong>
<p>
	The <code>Event</code> contains <code>EventType</code>, name (<code>null</code> if no name), <code>Value</code> and <code>int</code> level.
</p>

<strong>Value</strong>
<p>
	The <code>Code</code> holds JSON item value and <code>ValueType</code> (<code>NULL</code>, <code>BOOLEAN</code>, <code>INTEGER</code>, <code>DOUBLE</code> and <code>String</code>).
</p>

<strong>Example: construct</strong>
<p class="alert alert-dark code"><code>
	InputProvider provider = ...; <br>
	InputJsonStream stream = <span class="keyword">new</span> InputJsonStream(provider); <br>
	<span class="comment">// your code</span> <br>
	stream.close(); <br>
</code></p>

<strong>Example: reading</strong>
<p class="alert alert-dark code"><code>
	<span class="comment">// reading is more general, does not requried JSON example</span> <br>
	Event e = stream.next(); <br>
	while(e.hasNext()) { <br>
	<span class="tab"></span><span class="comment">// your code</span> <br>
	<span class="tab"></span>e = stream.next(); <br>
	} <br>
</code></p>

<h4>InputProvider</h4>

<p>
	Read data. JI Files contains two implementations:

	<ul>
		<li><code>InputStringProvider</code>: provide data from given String</li>
		<li><code>InputReaderProvider</code>: read data from given <code>Reader</code>. The <code>InputReaderProvider::close()</code> close <code>Reader</code>.</li>
	</ul>
</p>

<h2>JsonWriter</h2>

<p>
	Write any <code>Object</code> to JSON stream.
</p>

<p class="alert alert-dark code"><code>
	Object <span class="variable">data</span> = ...; <br>
	<span class="comment">// create JSON and returns it as string</span> <br>
	String json = <span class="keyword">new</span> JsonWritter().write(<span class="variable">data</span>); <br>
	<span class="comment">// write JSON to given OutputJsonStream</span> <br>
	OutputJsonStream <span class="variable">stream</span> = ...; <br>
	<span class="keyword"><span class="keyword">new</span></span> JsonWritter().write(<span class="variable">stream</span>, <span class="variable">data</span>);<br>
</code></p>

<p>
	The object will be written with following rules:
	<ul>
		<li><code>NULL</code> is <code>null</code></li>
		<li><code>Iterable</code> and <code>ListDictionary</code> are JSON list</li>
		<li><code>Map</code> and <code>MapDictionary</code> are JSON object</li>
		<li><code>Jsonable</code> (see bellow) - the final JSON is defined by <code>toJson</code> method</li>
		<li><code>Boolean</code> and <code>Number</code> are written with <code>toString</code> without quotes</li>
		<li>
			<code>Character</code>, <code>String</code>, <code>Enum</code>, <code>LocalDateTime</code>, 
			<code>ZonedDateTime</code>, <code>LocalTime</code>, <code>LocalDate</code> and <code>Date</code> are written as text with quotes
		</li>
		<li><code>DictionaryValue</code> is written as its value</li>
		<li><code>Optional</code> - if present, the value is written, otherwise <code>null</code></li>
		<li>Any other classes are serialized with JI Common <code>Mapper</code></li>
	</ul>
</p>

<p class="alert alert-danger">
	<strong>NOTE:</strong> serializing some native classes with <code>Mapper</code> can cause infinite recursion.
</p>

<h3>Jsonable</h3>

<h2>JsonReader</h2>